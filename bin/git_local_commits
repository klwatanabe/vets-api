#!/bin/bash

# for filename in $(git ls-files app/models/)
for filename in $(git ls-files lib/evss/ )
do
  # Extract the three most recent authors and timestamps
  # git blame filename --line-porcelain | grep    "^author " | sort | uniq -c | sort -r
    # authors=($(git blame `$filename` | grep "^author"))

  authors="$(git blame $filename --line-porcelain | grep "^author " | sort | uniq -c | sort -r )"
  timestamps=($(git log -3 --pretty=format:'%cD' -- "$filename"))
  month=${timestamps[2]:-''}
  year=${timestamps[3]:-''}
  echo "$filename, $authors, $month $year" >> git_most_commits.md

  # echo "$filename" >> codeowned_files.md

  # echo "$filename | $month $year | $authors " >> git_most_commits.md

done



# # Get Identity

# not_owned = Rails.root.join('not_owned.rb')

# lines = File.readlines(not_owned).grep(/Acct Experience/i)
# identity_files = []
# lines.each { |l| identity_files << l.gsub(" @department-of-veterans-affairs/vsp-identity\n", "") }


# identity_files = []
# lines.each { |l| identity_files << l.gsub("\n", "") }


#  array = File.readlines(file_invetory).to_a


# # Other files

# .dockerignore
# .gitattributes
# .github/CODEOWNERS
# .github/PULL_REQUEST_TEMPLATE.md
# .github/dependabot.yml
# .github/labeler.yml
# .github/settings.yml
# .github/workflows/build.yml
# .github/workflows/check_stale_prs.yml
# .github/workflows/code_checks.yml
# .github/workflows/danger.yml
# .github/workflows/delete_stale_branches.yml
# .github/workflows/labeler.yml
# .github/workflows/preview-environment-cleanup.yml
# .github/workflows/preview-environment-update-main.yml
# .github/workflows/preview_environment_deployment.yml
# .github/workflows/sync_branch.yml
# .gitignore
# .irbrc
# .rspec
# .rspec_parallel
# .rubocop.yml
# .rubocop_explicit_enables.yml
# .rubocop_todo.yml
# .ruby-version
# .yardopts
# Brewfile
# CONTRIBUTING.md
# Dangerfile
# Dockerfile
# Gemfile
# Gemfile.lock
# Guardfile
# Jenkinsfile
# LICENSE.md
# Makefile
# Procfile
# README.md
# Rakefile
# SECURITY.md
